# This tests a 2-pipe loop under the influence of gravity:
#
#      *-*
#      | |
#      | |    g |
#      | |      v
#      *-*
#      1 2
#
# This should develop a hydrostatic pressure distribution in both pipes,
# irrespective of their orientation convention.

[Model]
  model = 1phase
[]

[Physics]
  gravity = 9.8 0 0
[]

[Mesh]
  [mesh1]
    type = UniformMesh
    start = 0 0 0
    length = 1
    n_cell = 20
  []
  [mesh2]
    type = UniformMesh
    orientation = -1 0 0
    start = 1 0 0
    length = 1
    n_cell = 20
  []
[]

[EoS]
  [air]
    type = IdealGasEoS
    gamma = 1.4
    R = 290
  []
[]

[IC]
  [mesh1]
    T = 250
    u = 1
    p = 1e5
  []
  [mesh2]
    T = 250
    u = 1
    p = 1e5
  []
[]

[BC]
[]

[Junctions]
  [junction1]
    type = NewerCompressibleJunction
    phase = air
    mesh_names = mesh1 mesh2
    mesh_sides = right left
  []
  [junction2]
    type = NewerCompressibleJunction
    phase = air
    mesh_names = mesh1 mesh2
    mesh_sides = left  right
  []
[]

[Stabilization]
  type = NoStabilization
[]

[Executioner]
  type = ImplicitEulerExecutioner
  dt = 0.05
  end_time = 0.50
[]

[NonlinearSolver]
  verbose = True
  absolute_tolerance = 1e-6
  max_iterations = 10

  scaling_arhoA1  = 1
  scaling_arhouA1 = 1e-1
  scaling_arhoEA1 = 1e-5
[]

[Output]
  plot_solution = True
  plot_file = junction_loop.pdf
[]
